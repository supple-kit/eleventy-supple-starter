{% extends "layouts/base.njk" %}
{% set templateClass = 'tmpl-post' %}

{% set shareUrl = metadata.url + page.url %}

{% block content %}
  <article>
    <h1>{{ title }}</h1>

    {{ content | safe }}

    <aside>
      {% include "partials/components/share-widget.njk" %}

      <h2>Filed under:</h2>
      {% for tag in tags | tagList %}
        {% set tagUrl %}/tags/{{ tag | slug }}/{% endset %}
        <a href="{{ tagUrl | url }}">{{ tag }}</a>
      {% endfor %}
    </aside>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "{{ title }}",
      "image": [],
      "author": "{{ metadata.author.name }}",
      "genre": "{{ metadata.genre }}",
      "publisher": {
        "@type": "Organization",
        "name": "{{ metadata.publisher.name }}",
        "logo": {
          "@type": "ImageObject",
          "url": "{{ '/manifest/icon-144x144.png' }}"
        }
      },
      "url": "{{ metadata.url }}{{ canonicalUrl or page.url }}",
      "mainEntityOfPage": "{{ metadata.url }}{{ canonicalUrl or page.url }}",
      "datePublished": "{{ page.date | htmlDateString }}",
      "description": "{{ content | striptags | truncate(140) }}"
    }
    </script>
  </article>
{% endblock %}
